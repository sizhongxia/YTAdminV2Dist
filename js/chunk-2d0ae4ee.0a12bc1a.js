(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ae4ee"],{"0a07":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",{staticClass:"search-con",attrs:{shadow:""}},[a("Form",{ref:"searchFormObj",attrs:{model:t.searchFormObj}},[a("Input",{staticClass:"search-input",attrs:{placeholder:"按Banner名称查询",clearable:""},model:{value:t.searchFormObj.title,callback:function(e){t.$set(t.searchFormObj,"title",e)},expression:"searchFormObj.title"}}),t._v("  \n      "),a("Select",{staticStyle:{width:"220px"},attrs:{placeholder:"按Banner展示位置查询",clearable:""},model:{value:t.searchFormObj.displayPosition,callback:function(e){t.$set(t.searchFormObj,"displayPosition",e)},expression:"searchFormObj.displayPosition"}},[a("Option",{attrs:{value:""}},[t._v("全部")]),a("Option",{attrs:{value:"KC"}},[t._v("课程")]),a("Option",{attrs:{value:"5S"}},[t._v("换油中心(5S店)")])],1),t._v("  \n      "),a("Button",{staticClass:"search-btn",attrs:{type:"primary"},on:{click:t.handleSearch}},[a("Icon",{attrs:{type:"ios-search-outline"}}),t._v(" 检索")],1)],1)],1),a("Button",{staticStyle:{"margin-bottom":"18px"},attrs:{type:"primary",icon:"ios-add-circle-outline"},on:{click:t.showCreateForm}},[t._v("新增")]),a("Table",{attrs:{border:!1,stripe:!0,"show-header":!0,data:t.tableData,loading:t.loading,columns:t.columns,size:"default","highlight-row":!0,editable:""},on:{"on-sort-change":t.handleSortChange}}),a("div",{staticClass:"page"},[a("Page",{attrs:{total:t.total,current:t.searchFormObj.current,"page-size":t.searchFormObj.size,"show-sizer":"","show-total":"","show-elevator":""},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}})],1),a("Modal",{attrs:{title:""===t.formObj.resId?"新增":"修改",width:"560",scrollable:"",mask:"","mask-closable":!1,closable:!1,"class-name":"vertical-center-modal"},model:{value:t.baseFormModel,callback:function(e){t.baseFormModel=e},expression:"baseFormModel"}},[a("Form",{ref:"baseForm",attrs:{model:t.formObj,"label-width":120,rules:t.ruleValidate}},[a("FormItem",{attrs:{label:"名称",prop:"title"}},[a("Input",{staticStyle:{width:"320px"},attrs:{placeholder:"请输入Banner广告图名称"},model:{value:t.formObj.title,callback:function(e){t.$set(t.formObj,"title",e)},expression:"formObj.title"}})],1),a("FormItem",{attrs:{label:"广告图",prop:"picUrl"}},[a("Input",{staticStyle:{width:"320px"},attrs:{placeholder:"请上传一张广告图",disabled:""},model:{value:t.formObj.picUrl,callback:function(e){t.$set(t.formObj,"picUrl",e)},expression:"formObj.picUrl"}},[a("Button",{attrs:{slot:"append",icon:"ios-cloud-upload-outline"},on:{click:t.uploadBannerPicUrl},slot:"append"},[t._v("上传")])],1)],1),a("div",{staticStyle:{"text-align":"center"}},[t.formObj.picUrl?a("img",{staticStyle:{width:"260px","min-height":"60px",display:"block",margin:"10px auto"},attrs:{src:t.formObj.picUrl},on:{click:function(e){t.showBigPictureModel(t.formObj.picUrl)}}}):t._e()]),a("FormItem",{attrs:{label:"位置",placeholder:"请选择Banner广告图显示位置",prop:"displayPosition"}},[a("Select",{staticStyle:{width:"320px"},attrs:{clearable:""},model:{value:t.formObj.displayPosition,callback:function(e){t.$set(t.formObj,"displayPosition",e)},expression:"formObj.displayPosition"}},[a("Option",{attrs:{value:"KC"}},[t._v("课程")]),a("Option",{attrs:{value:"5S"}},[t._v("换油中心(5S店)")])],1)],1),a("FormItem",{attrs:{label:"链接",prop:"linkUrl"}},[a("Input",{staticStyle:{width:"320px"},attrs:{placeholder:"请输入Banner广告图链接"},model:{value:t.formObj.linkUrl,callback:function(e){t.$set(t.formObj,"linkUrl",e)},expression:"formObj.linkUrl"}})],1)],1),t.submiting?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"text"},on:{click:t.closeBaseFormHandle}},[t._v("关闭")]),a("Button",{attrs:{type:"primary"},on:{click:t.submitBaseFormHandle}},[t._v("提交")])],1)],1),a("Modal",{model:{value:t.uploadBannerPicModel,callback:function(e){t.uploadBannerPicModel=e},expression:"uploadBannerPicModel"}},[a("div",{attrs:{slot:"header"},slot:"header"},[t._v("上传图片")]),a("Upload",{attrs:{type:"drag",accept:".jpg,.png,.gif",multiple:!1,format:t.uploadFormat,headers:t.uploadHeaders,"before-upload":t.uploadPicBeforeHandle,"on-success":t.uploadPicSuccessHandle,"on-error":t.uploadPicErrorHandle,"on-format-error":t.uploadPicErrorFormatHandle,"on-exceeded-size":t.uploadPicErrorSizeHandle,"max-size":4096,"show-upload-list":!1,action:t.baseUrl+"upload"}},[a("div",{staticStyle:{padding:"20px 0"}},[a("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),a("p",[t._v("单击或拖动文件到此处上传")])],1),t.picUploading?a("Spin",{attrs:{size:"large",fix:""}}):t._e()],1),a("div",{attrs:{slot:"footer"},slot:"footer"})],1),a("Modal",{attrs:{draggable:"",width:"750","footer-hide":!0},model:{value:t.picModelVisible,callback:function(e){t.picModelVisible=e},expression:"picModelVisible"}},[a("div",{attrs:{slot:"header"},slot:"header"},[t._v("图片大图")]),t.picModelPicUrl?a("img",{staticStyle:{width:"100%"},attrs:{src:t.picModelPicUrl}}):t._e()])],1)},i=[],r=(a("cadf"),a("551c"),a("097d"),a("66df")),l=function(t){return r["a"].request({url:"banner/list",data:t,method:"post"})},s=function(t){return r["a"].request({url:"banner/upinsert",data:t,method:"post"})},n=function(t){var e={resId:t};return r["a"].request({url:"banner/detail",data:e,method:"post"})},d=function(t){var e={resId:t};return r["a"].request({url:"banner/delete",data:e,method:"post"})},c=a("f121"),p={data:function(){return{searchFormObj:{current:1,size:10,orderField:"",orderType:"",title:"",displayPosition:""},loading:!1,tableData:[],total:0,submiting:!1,formObj:{resId:"",title:"",picUrl:"",displayPosition:"",linkUrl:""},baseFormModel:!1,deleting:!1,uploadBannerPicModel:!1,baseUrl:c["a"].baseUrl.pro,uploadFormat:["jpg","png","gif"],uploadHeaders:{type:"banner"},picUploading:!1,picModelVisible:!1,picModelPicUrl:""}},computed:{columns:function(){var t=this;return[{title:" ",key:"action",width:180,fixed:"right",render:function(e,a){return e("div",[e("Button",{props:{type:"text"},on:{click:function(){t.showEditForm(a)}}},"编辑"),e("Poptip",{props:{transfer:!0,confirm:!0,title:"确认要删除此记录吗？"},on:{"on-ok":function(){t.handleDelete(a)}}},[e("Button",{props:{type:"text",loading:t.deleting}},"删除")])])}},{type:"index",width:60,align:"center"},{title:"名称",key:"title",minWidth:200,tooltip:!0},{title:"显示位置",key:"displayPosition",sortable:"custom",minWidth:120,tooltip:!0},{title:"图片地址",key:"picUrl",minWidth:200,tooltip:!0},{title:"链接地址",key:"linkUrl",minWidth:200,tooltip:!0},{title:"链接访问量",key:"statisticPv",sortable:"custom",minWidth:140,tooltip:!0},{title:"独立访问量",key:"statisticUv",sortable:"custom",minWidth:140,tooltip:!0},{title:"版本",key:"version",minWidth:80,tooltip:!0},{title:"创建时间",sortable:"custom",width:210,key:"createAt"},{title:"最后编辑时间",sortable:"custom",width:210,key:"updateAt"}]},ruleValidate:function(){return{title:[{required:!0,message:"Banner广告名称不允许为空",trigger:"blur"}],picUrl:[{required:!0,message:"请上传一张Banner广告图片",trigger:"blur"}],displayPosition:[{required:!0,message:"请选择Banner广告图要显示的位置",trigger:"blur"}],linkUrl:[{required:!0,message:"请输入Banner广告图跳转链接",trigger:"blur"}]}}},methods:{load:function(){var t=this;t.loading=!0,l(t.searchFormObj).then(function(e){if(t.loading=!1,200===e.status&&200===e.data.code){var a=e.data.data;t.tableData=a.list,t.total=a.total}}).catch(function(e){t.$Modal.error({title:e.message}),t.tableData=[],t.loading=!1})},handleSearch:function(t){this.load()},changePage:function(t){this.searchFormObj.current=t,this.load()},changePageSize:function(t){this.searchFormObj.size=t,this.load()},handleSortChange:function(t){this.searchFormObj.orderField=t.key,this.searchFormObj.orderType=t.order,this.load()},showCreateForm:function(){this.formObj={resId:"",title:"",picUrl:"",displayPosition:"",linkUrl:""},this.baseFormModel=!0},showEditForm:function(t){var e=this;e.loading=!0,n(t.row.resId).then(function(t){e.loading=!1,200===t.status&&200===t.data.code&&(e.formObj=t.data.data,e.baseFormModel=!0)}).catch(function(t){e.loading=!1,e.$Modal.error({title:t.message})})},submitBaseFormHandle:function(){var t=this;t.$refs["baseForm"].validate(function(e){e&&(t.submiting=!0,s(t.formObj).then(function(e){t.submiting=!1,200===e.status&&200===e.data.code?(t.closeBaseFormHandle(),t.load()):t.$Modal.error({title:e.data.message})}).catch(function(e){t.submiting=!1,t.closeBaseFormHandle(),t.$Modal.error({title:e.message})}))})},closeBaseFormHandle:function(){this.$refs["baseForm"].resetFields(),this.baseFormModel=!1},handleDelete:function(t){var e=this,a=this;a.deleting=!0,d(t.row.resId).then(function(t){a.deleting=!1,200===t.status&&200===t.data.code?e.load():a.$Modal.error({title:t.data.message})}).catch(function(t){a.deleting=!1,a.$Modal.error({title:t.message})})},uploadBannerPicUrl:function(){this.uploadBannerPicModel=!0},uploadPicBeforeHandle:function(){this.picUploading=!0},uploadPicSuccessHandle:function(t,e){this.formObj.picUrl=e.response.data,this.uploadBannerPicModel=!1,this.picUploading=!1},uploadPicErrorHandle:function(t){var e=this;e.picUploading=!1,e.$Modal.error({title:"上传失败，请稍后重试"})},uploadPicErrorSizeHandle:function(t){var e=this;e.picUploading=!1,e.$Modal.error({title:"图片太大，请压缩后重试"})},uploadPicErrorFormatHandle:function(t,e){var a=this;a.picUploading=!1,a.$Modal.error({title:"图片格式错误"})},showBigPictureModel:function(t){this.picModelVisible=!0,this.picModelPicUrl=t}},mounted:function(){this.load()}},u=p,m=a("2877"),h=Object(m["a"])(u,o,i,!1,null,null,null);e["default"]=h.exports}}]);